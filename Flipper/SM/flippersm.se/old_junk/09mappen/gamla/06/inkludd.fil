<?php
include("sm06.includes.header.php");
php?>


<div id="resultat">
<table class="resultat">
  <tr><td> Entry-<br>nummer: </td><td> Spelar-<br>nummer: </td><td> Tag: </td><td> Namn: </td><td> Hemort: </td><td> Kvalpoäng: </td><td> Spel: </td><td> Förk: </td><td> Spelpoäng: </td></tr>

<?php

// handle sorting order
$arySort = array("entry" => "Try_id",
                 "no" => "Player_no",
                 "tag" => "Tag",
                 "namn" => "Name",
                 "kval" => "Qual_points",
                 "spel" => "Game_id",
                 "spelpoäng" => "Game_points");

$strSortorder = $_GET['sortby'];
if(is_null($strSortorder))  {
    $sqlSort = "";  }
else
    {
    $sqlSort = " ORDER BY " . $arySort[$strSortorder];
    if(strpos($arySort[$strSortorder], "points"))  {
        $sqlSort .= " DESC";  }
    }

// open connection
//$db = MySQL_connect("localhost", "sm", "slamtilt");
$db = MySQL_connect("83.248.90.117", "webb", "ngt3vligt");
MySQL_select_db("sm06", $db);


// get data
$sql = "SELECT Qual.Try_id, Qual.Player_no, Qual.Tag, Qual.Name, Qual.City, Qual.Qual_points, Qual.Game_id, Qual.Game_points, Games.Game_name, Games.Game_abb FROM Qual LEFT JOIN Games ON Qual.Game_id = Games.Game_id" . $sqlSort;
$sqlResult = MySQL_query($sql,$db);

$intRows = MYSQL_num_rows($sqlResult);


// display data
for($c=0; $c<$intRows; $c++)
    {
    echo "  <tr>";
    printf("<td align=\"center\"> %s </td>", MySQL_result($sqlResult,$c,$arySort["entry"]));
    printf("<td align=\"center\"> %s </td>", MySQL_result($sqlResult,$c,$arySort["no"]));
    printf("<td> <a href=\"showentry.php?id=%s\">%s</a> </td>", MySQL_result($sqlResult,$c,$arySort["no"]), MySQL_result($sqlResult,$c,$arySort["tag"]));
    printf("<td> %s </td>", MySQL_result($sqlResult,$c,$arySort["namn"]));
    printf("<td> %s </td>", MySQL_result($sqlResult,$c,"City"));
    printf("<td align=\"center\"> %s </td>", MySQL_result($sqlResult,$c,$arySort["kval"]));
    printf("<td> <a href=\"showgame.php?id=%s\">%s</a> </td>", MySQL_result($sqlResult,$c,"Game_id"), MySQL_result($sqlResult,$c,"Game_name"));
    printf("<td> %s </td>", MySQL_result($sqlResult,$c,"Game_abb"));
    printf("<td align=\"right\"> %s </td>", number_format(MySQL_result($sqlResult,$c,"Game_points"),0,"."," "));
    echo "</tr>\n";
    }

MySQL_close($db);

?>

</table><br><br>
</div>
